<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Greek God Quiz</title>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <style>
        /* Basic Reset & Body Styles */
        :root {
            --primary-color: #EAA64D; /* Dark Purple */
            --secondary-color: #ffd700; /* Gold */
            --text-color: #333;
            --bg-color: #f4f4f4;
            --card-color: rgba(255, 255, 255, 0.85); /* Light with transparency */
            --nav-bg-color: rgba(52, 58, 64, 0.9); /* Darker grey with transparency */
            --button-bg: var(--primary-color);
            --button-text: white;
            --button-hover-bg: #000000; /* Slightly lighter purple */
            --border-color: #ddd;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --primary-color: #EAA64D; /* Lighter Purple for dark mode */
            --secondary-color: #f0c300; /* Slightly darker gold */
            --text-color: #e0e0e0;
            --bg-color: #121212;
            --card-color: rgba(52, 58, 64, 0.85); /* Dark grey with transparency */
            --nav-bg-color: rgba(26, 26, 26, 0.9); /* Even darker grey with transparency */
            --button-bg: #EAA64D; /* Purple */
            --button-text: white;
            --button-hover-bg: #50221a; /* Lighter purple */
            --border-color: #444;
            --shadow-color: rgba(0, 0, 0, 0.3);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            background: var(--bg-color) url('https://upload.wikimedia.org/wikipedia/commons/b/b3/Mount_Olympus_Macedonia_Greece.jpg') no-repeat center center fixed;
            background-size: cover;
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 60px; /* Space for fixed navbar */
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .container {
            background-color: var(--card-color);
            border-radius: 15px;
            box-shadow: 0 8px 25px var(--shadow-color);
            padding: 30px;
            margin: 20px auto;
            max-width: 800px;
            width: 90%;
            text-align: center;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        /* Navigation Bar */
        .navbar {
            width: 100%;
            background-color: var(--nav-bg-color);
            padding: 10px 0;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px var(--shadow-color);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .nav-links {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            gap: 20px;
        }

        .nav-links li a {
            color: var(--secondary-color);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 15px;
            border-radius: 8px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .nav-links li a:hover,
        .nav-links li a.active {
            background-color: var(--primary-color);
            color: var(--button-text);
        }

        .navbar-controls {
            position: absolute;
            right: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .navbar-controls select,
        .navbar-controls button {
            padding: 5px 10px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            background-color: var(--card-color);
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .navbar-controls select:hover,
        .navbar-controls button:hover {
            background-color: var(--button-hover-bg);
            color: var(--button-text);
            border-color: var(--button-hover-bg);
        }

        /* Quiz Section */
        #quiz-section h1 {
            font-family: 'Merriweather', serif;
            color: var(--primary-color);
            margin-bottom: 25px;
            font-size: 2.5em;
        }

        #question-box {
            font-size: 1.4em;
            margin-bottom: 30px;
            color: var(--text-color);
            font-weight: 600;
        }

        #buttons {
            display: grid;
            gap: 15px;
            margin-bottom: 30px;
        }

        #buttons button {
            background-color: var(--button-bg);
            color: var(--button-text);
            border: none;
            border-radius: 10px;
            padding: 15px 25px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 8px var(--shadow-color);
        }

        #buttons button:hover {
            background-color: var(--button-hover-bg);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px var(--shadow-color);
        }

        #buttons button.selected {
            background-color: var(--secondary-color);
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(255, 215, 0, 0.4);
        }

        .quiz-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }

        .quiz-navigation button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .quiz-navigation button:hover {
            background-color: var(--button-hover-bg);
        }

        #progress-indicator {
            font-size: 0.9em;
            color: var(--text-color);
            opacity: 0.8;
        }

        /* Result Section */
        #result {
            margin-top: 20px;
        }

        #result h2 {
            font-family: 'Merriweather', serif;
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 2em;
        }

        #result img {
            max-width: 250px;
            border-radius: 50%;
            border: 5px solid var(--secondary-color);
            margin-bottom: 20px;
            box-shadow: 0 5px 15px var(--shadow-color);
        }

        #result p {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 15px;
            color: var(--text-color);
        }

        .reason-text {
            font-style: italic;
            color: var(--primary-color);
            font-weight: 600;
        }

        #result button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 15px 30px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            margin-top: 20px;
            box-shadow: 0 4px 8px var(--shadow-color);
        }

        #result button:hover {
            background-color: var(--button-hover-bg);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px var(--shadow-color);
        }

        .source-link {
            display: block;
            margin-top: 15px;
            color: var(--primary-color);
            text-decoration: none;
            font-size: 0.9em;
            opacity: 0.8;
            transition: opacity 0.3s ease, color 0.3s ease;
        }

        .source-link:hover {
            opacity: 1;
            color: var(--secondary-color);
        }

        /* History Section */
        #history-section h1 {
            font-family: 'Merriweather', serif;
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 2.5em;
        }

        #history-intro {
            font-size: 1.1em;
            margin-bottom: 30px;
            color: var(--text-color);
        }

        #god-card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            padding: 20px;
        }

        .god-card {
            background-color: var(--card-color);
            border-radius: 10px;
            box-shadow: 0 4px 15px var(--shadow-color);
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .god-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 25px var(--shadow-color);
        }

        .god-card img {
            max-width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 50%;
            border: 3px solid var(--secondary-color);
            margin-bottom: 15px;
        }

        .god-card h3 {
            font-family: 'Merriweather', serif;
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.5em;
        }

        .god-card p {
            font-size: 0.95em;
            color: var(--text-color);
            flex-grow: 1;
            margin-bottom: 15px;
        }

        .god-card .source-link {
            font-size: 0.8em;
            margin-top: 10px;
        }

        /* God Detail View */
        #god-detail-view {
            text-align: center;
        }

        #god-detail-view h2 {
            font-family: 'Merriweather', serif;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 2.2em;
        }

        #god-detail-view img {
            max-width: 300px;
            border-radius: 50%;
            border: 6px solid var(--secondary-color);
            margin-bottom: 25px;
            box-shadow: 0 6px 20px var(--shadow-color);
        }

        #god-detail-view p {
            font-size: 1.15em;
            line-height: 1.8;
            margin-bottom: 25px;
            color: var(--text-color);
        }

        #back-to-history-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 15px 30px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 8px var(--shadow-color);
            margin-top: 20px;
        }

        #back-to-history-btn:hover {
            background-color: var(--button-hover-bg);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px var(--shadow-color);
        }

        .detail-source-link {
            display: block;
            margin-top: 15px;
            color: var(--primary-color);
            text-decoration: none;
            font-size: 1em;
            opacity: 0.8;
            transition: opacity 0.3s ease, color 0.3s ease;
        }
        .detail-source-link:hover {
            opacity: 1;
            color: var(--secondary-color);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 15px auto;
            }

            #quiz-section h1, #history-section h1 {
                font-size: 2em;
            }

            #question-box {
                font-size: 1.2em;
            }

            #buttons button {
                padding: 12px 20px;
                font-size: 1em;
            }

            #result h2, #god-detail-view h2 {
                font-size: 1.8em;
            }

            #result img, #god-detail-view img {
                max-width: 200px;
            }

            #god-card-grid {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                gap: 15px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding-top: 50px;
            }
            .navbar {
                padding: 8px 0;
            }
            .nav-links {
                gap: 10px;
            }
            .nav-links li a {
                padding: 6px 10px;
                font-size: 0.9em;
            }
            .navbar-controls {
                right: 10px;
                gap: 10px;
            }
            .navbar-controls select,
            .navbar-controls button {
                padding: 3px 8px;
                font-size: 0.9em;
            }

            .container {
                padding: 15px;
                width: 95%;
            }

            #quiz-section h1, #history-section h1 {
                font-size: 1.8em;
            }

            #question-box {
                font-size: 1.1em;
            }

            #buttons button {
                padding: 10px 15px;
                font-size: 0.95em;
            }

            #result h2, #god-detail-view h2 {
                font-size: 1.5em;
            }

            #result img, #god-detail-view img {
                max-width: 150px;
            }

            #result p, #god-detail-view p {
                font-size: 1em;
            }

            #result button, #back-to-history-btn {
                padding: 12px 20px;
                font-size: 1em;
            }

            .god-card img {
                max-width: 100px;
                height: 100px;
            }

            .god-card h3 {
                font-size: 1.3em;
            }
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <ul class="nav-links">
            <li><a href="#" id="quiz-nav-link" class="active" onclick="showSection('quiz')">Quiz</a></li>
            <li><a href="#" id="history-nav-link" onclick="showSection('history')">God History</a></li>
        </ul>
        <div class="navbar-controls">
            <select id="langToggle">
                <option value="en">English</option>
                <option value="th">ไทย</option>
                <option value="zh">中文</option>
            </select>
            <button onclick="toggleTheme()">Theme</button>
        </div>
    </nav>

    <div class="container" id="quiz-section">
        <h1 id="quiz-title">Which Greek God Are You?</h1>
        <div id="quiz-container">
            <div id="question-box"></div>
            <div id="buttons"></div>
            <div class="quiz-navigation">
                <button id="prev-btn" onclick="prevQuestion()"></button>
                <span id="progress-indicator"></span>
            </div>
        </div>
        <div id="result"></div>
    </div>

    <div class="container" id="history-section" style="display: none;">
        <h1 id="history-title">History of Greek Gods</h1>
        <p id="history-intro">Click on each god to learn more.</p>
        <div id="god-card-grid">
            </div>

        <div id="god-detail-view" style="display: none;">
            <img id="detail-god-img" src="" alt="">
            <h2 id="detail-god-name"></h2>
            <p id="detail-god-desc"></p>
            <a id="detail-god-source" href="" target="_blank" class="detail-source-link"></a>
            <button id="back-to-history-btn" onclick="showHistoryList()"></button>
        </div>
    </div>

    <script>
        const translations = {
            th: {
                title: "คุณเป็นเทพเจ้าองค์ใดในตำนานกรีก?",
                resultPrefix: "คุณเหมือนกับเทพเจ้า",
                reasonPrefix: "เพราะว่าคุณเป็นคน",
                prevBtn: "ย้อนกลับ",
                nextBtn: "ถัดไป",
                restartBtn: "เริ่มใหม่",
                progressText: "คำถามที่ {current} จาก {total}",
                quizNavLink: "ควิซ",
                historyNavLink: "ประวัติเทพเจ้า",
                historyTitle: "ประวัติเทพเจ้ากรีก",
                historyIntro: "คลิกที่เทพเจ้าแต่ละองค์เพื่อดูรายละเอียดเพิ่มเติม",
                backToHistoryBtn: "กลับสู่หน้ารายชื่อเทพ",
                cannotProcessResult: "ไม่สามารถประมวลผลผลลัพธ์ได้",
                sourceLinkText: "แหล่งอ้างอิงข้อมูล: Wikipedia"
            },
            en: {
                title: "Which Greek God Are You?",
                resultPrefix: "You are like the god",
                reasonPrefix: "Because you are",
                prevBtn: "Previous",
                nextBtn: "Next",
                restartBtn: "Restart Quiz",
                progressText: "Question {current} of {total}",
                quizNavLink: "Quiz",
                historyNavLink: "God History",
                historyTitle: "History of Greek Gods",
                historyIntro: "Click on each god to learn more.",
                backToHistoryBtn: "Back to God List",
                cannotProcessResult: "Cannot process result",
                sourceLinkText: "Data Source: Wikipedia"
            },
            zh: {
                title: "你是希腊神话中的哪位神?",
                resultPrefix: "你像希腊神话中的",
                reasonPrefix: "因为你是一个",
                prevBtn: "上一题",
                nextBtn: "下一题",
                restartBtn: "重新开始",
                progressText: "第 {current} 题 共 {total} 题",
                quizNavLink: "测验",
                historyNavLink: "神话历史",
                historyTitle: "希腊神话历史",
                historyIntro: "点击每位神灵了解更多信息。",
                backToHistoryBtn: "返回神灵列表",
                cannotProcessResult: "无法处理结果",
                sourceLinkText: "数据来源：维基百科"
            }
        };

        const godData = {
            Zeus: { name: { th: "ซูส", en: "Zeus", zh: "宙斯" }, img: "https://cdn.discordapp.com/attachments/893104637656334348/1389977275771912252/Zeus.jpg?ex=686694b7&is=68654337&hm=ffc9f3fc6748e1173cd6f78943c2a288feacafaf200e36e2f742066b8d0b5bfb&", desc: { th: "เทพแห่งสายฟ้าและราชาแห่งเทพเจ้าผู้ปกครองเขาโอลิมปัส เป็นผู้ควบคุมสภาพอากาศและสัญลักษณ์ของอำนาจ ความยุติธรรม และกฎระเบียบ เขามักถูกวาดภาพคู่กับสายฟ้าและนกอินทรี", en: "God of thunder and king of the gods, ruler of Mount Olympus. He controls weather and symbolizes power, justice, and order. He is often depicted with a lightning bolt and an eagle.", zh: "雷电之神，奥林匹斯山之王。他掌控天气，象征着权力、正义和秩序。他常被描绘成手持闪电，身边伴有老鹰。" }, reason: { th: "มีภาวะผู้นำ, เด็ดขาด, และรักความยุติธรรม", en: "a decisive, powerful leader who values justice", zh: "果断、强大、重视正义的领导者" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B8%8B%E0%B8%B9%E0%B8%AA", en: "https://en.wikipedia.org/wiki/Zeus", zh: "https://zh.wikipedia.org/wiki/%E4%BF%84%E5%A3%AB%E6%8B%89" } },
            Hera: { name: { th: "เฮร่า", en: "Hera", zh: "赫拉" }, img: "https://media.discordapp.net/attachments/893104637656334348/1389977296957607967/hera.jpg?ex=686694bc&is=6865433c&hm=56ecfe9a02f06718a06db04e9a71a11038ecfe388d688ef4dbe78e6e69b0850f&=&format=webp&width=499&height=800", desc: { th: "เทพีแห่งการแต่งงาน สตรี การคลอดบุตร และครอบครัว เป็นราชินีแห่งโอลิมปัสและภรรยาของซูส เธอมักถูกวาดภาพด้วยมงกุฎและคทา", en: "Goddess of marriage, women, childbirth, and family. She is the Queen of Olympus and wife of Zeus. She is often depicted with a diadem and a scepter.", zh: "婚姻、妇女、生育和家庭女神，奥林匹斯山女王，宙斯的妻子。她常被描绘成头戴王冠，手持权杖。" }, reason: { th: "รักครอบครัว, มีความภักดี, และเป็นผู้ปกป้อง", en: "loyal, protective, and deeply devoted to family", zh: "忠诚、有保护欲、非常顾家" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B9%80%E0%B8%AE%E0%B8%A3%E0%B9%88%E0%B8%B2", en: "https://en.wikipedia.org/wiki/Hera", zh: "https://zh.wikipedia.org/wiki/%E8%B5%AB%E6%8B%89" } },
            Poseidon: { name: { th: "โพไซดอน", en: "Poseidon", zh: "波塞冬" }, img: "https://media.discordapp.net/attachments/893104637656334348/1389977278020194441/poseidon.jpg?ex=686694b7&is=68654337&hm=e65969820991c670cc0c42ae1019173b46fc868997b5dfdd53340031564b8937&=&format=webp&width=499&height=799", desc: { th: "เทพแห่งท้องทะเล แผ่นดินไหว และม้า เป็นพี่ชายของซูสและฮาเดส เขามีอารมณ์รุนแรงและมักถูกวาดภาพคู่กับตรีศูล", en: "God of the sea, earthquakes, and horses. He is a brother of Zeus and Hades, known for his violent temper and is often depicted with a trident.", zh: "海洋、地震和马匹之神，宙斯和哈迪斯的兄弟。他性情暴躁，常被描绘成手持三叉戟。" }, reason: { th: "รักอิสระ, มีพลังขับเคลื่อน, และอาจมีอารมณ์ที่รุนแรง", en: "free-spirited, powerful, and sometimes tempestuous", zh: "热爱自由、力量强大，有时性情暴躁" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B9%82%E0%B8%9E%E0%B9%84%E0%B8%8B%E0%B8%94%E0%B8%AD%E0%B8%99", en: "https://en.wikipedia.org/wiki/Poseidon", zh: "https://zh.wikipedia.org/wiki/%E6%B3%A2%E5%A1%9E%E5%86%AC" } },
            Demeter: { name: { th: "ดีมีเทอร์", en: "Demeter", zh: "得墨忒耳" }, img: "https://media.discordapp.net/attachments/893104637656334348/1389977278703734857/demeter.jpg?ex=686694b7&is=68654337&hm=70495da3fbf6aebd33d480ec8c1835d0eda1337704ea0cd98ac150e51b2686d8&=&format=webp&width=499&height=799", desc: { th: "เทพีแห่งการเกษตร การเก็บเกี่ยว ความอุดมสมบูรณ์ และกฎแห่งธรรมชาติ เป็นผู้ให้กำเนิดพืชผลและอาหารแก่มนุษย์ เธอเป็นเทพีที่ใจดีและรักการดูแล", en: "Goddess of agriculture, harvest, fertility, and sacred law. She is the giver of grain and food to mankind. She is a kind and nurturing goddess.", zh: "农业、收获、丰饶和自然法则女神，为人类提供谷物和食物。她是一位仁慈且富有母性的女神。" }, reason: { th: "ใจดี, มีความเมตตา, และรักการดูแลผู้อื่น", en: "kind, nurturing, and compassionate towards others", zh: "善良、有爱心、乐于照顾他人" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B8%94%E0%B8%B5%E0%B8%A1%E0%B8%B5%E0%B9%80%E0%B8%97%E0%B8%AD%E0%B8%A3%E0%B9%8C", en: "https://en.wikipedia.org/wiki/Demeter", zh: "https://zh.wikipedia.org/wiki/%E5%BE%97%E5%A2%A8%E5%BF%92%E8%80%B3" } },
            Athena: { name: { th: "อธีนา", en: "Athena", zh: "雅典娜" }, img: "https://media.discordapp.net/attachments/893104637656334348/1389977276497662022/athena.jpg?ex=686694b7&is=68654337&hm=3b262777213dec400c4ebd8ce236c0329296349f8af28095a0b9f1c52aac2c1b&=&format=webp&width=499&height=800", desc: { th: "เทพีแห่งปัญญา สงครามยุทธวิธี งานฝีมือ และศิลปะ เธอเกิดจากศีรษะของซูสอย่างเต็มตัวและติดอาวุธ เป็นผู้กล้าหาญและรอบรู้", en: "Goddess of wisdom, strategic warfare, handicrafts, and art. She was born fully grown and armed from Zeus's head. She is brave and highly knowledgeable.", zh: "智慧、策略性战争、手工艺和艺术女神。她从宙斯的头颅中全副武装地诞生。她勇敢而博学多才。" }, reason: { th: "ชาญฉลาด, มีเหตุผล, และวางแผนเก่ง", en: "wise, strategic, and logical in your approach", zh: "聪明、有策略、理性" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B8%AD%E0%B8%B0%E0%B8%98%E0%B8%B5%E0%B8%99%E0%B8%B2", en: "https://en.wikipedia.org/wiki/Athena", zh: "https://zh.wikipedia.org/wiki/%E9%9B%85%E5%85%B8%E5%A8%9C" } },
            Apollo: { name: { th: "อะพอลโล", en: "Apollo", zh: "阿波罗" }, img: "https://media.discordapp.net/attachments/893104637656334348/1389977276871086150/apollo.jpg?ex=686694b7&is=68654337&hm=6e02b22f4d9b59fdab3343bc968b28de46d1ccd68eafd12916412b1c8463d94c&=&format=webp&width=499&height=800", desc: { th: "เทพแห่งดนตรี กวีนิพนธ์ แสง การรักษาโรค และการพยากรณ์ เป็นผู้นำของเหล่ามิวส์และเป็นเทพแห่งความงามและสมดุล", en: "God of music, poetry, light, healing, and prophecy. He is the leader of the Muses and a god of beauty and balance.", zh: "音乐、诗歌、光明、治疗和预言之神。他是缪斯女神的领袖，是美与平衡的象征。" }, reason: { th: "มีศิลปะในหัวใจ, ชอบความสวยงาม, และมองโลกในแง่ดี", en: "artistic, appreciative of beauty, and optimistic", zh: "有艺术气息、热爱美、乐观" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B8%AD%E0%B8%B0%E0%B8%9E%E0%B8%AD%E0%B8%A5%E0%B9%82%E0%B8%A5", en: "https://en.wikipedia.org/wiki/Apollo", zh: "https://zh.wikipedia.org/wiki/%E9%98%BF%E6%B3%A2%E7%BD%97" } },
            Artemis: { name: { th: "อาร์เทมิส", en: "Artemis", zh: "阿耳忒弥斯" }, img: "https://media.discordapp.net/attachments/893104637656334348/1389977277210693768/artemis.jpg?ex=686694b7&is=68654337&hm=b531af7b70a801f1ae17378d6dab1f0edecd18bc68e67735be3a4c751867bc70&=&format=webp&width=499&height=800", desc: { th: "เทพีแห่งการล่า ป่า สัตว์ป่า และดวงจันทร์ เป็นเทพีพรหมจารีและผู้พิทักษ์ธรรมชาติ เธอเป็นอิสระและรักอิสรภาพ", en: "Goddess of the hunt, wilderness, wild animals, and the moon. She is a virgin goddess and protector of nature. She is independent and loves freedom.", zh: "狩猎、荒野、野生动物和月亮女神。她是一位贞洁的女神，也是大自然的守护者。她独立且热爱自由。" }, reason: { th: "รักอิสระ, มีความมุ่งมั่น, และรักธรรมชาติ", en: "independent, determined, and connected to nature", zh: "独立、坚定、热爱大自然" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B8%AD%E0%B8%B2%E0%B8%A3%E0%B9%8C%E0%B9%80%E0%B8%97%E0%B8%A1%E0%B8%B4%E0%B8%AA", en: "https://en.wikipedia.org/wiki/Artemis", zh: "https://zh.wikipedia.org/wiki/%E9%98%BF%E5%B0%94%E5%BF%AB%E5%BC%A5%E6%96%AF" } },
            Ares: { name: { th: "แอรีส", en: "Ares", zh: "阿瑞斯" }, img: "https://media.discordapp.net/attachments/893104637656334348/1389977276208386048/ares.jpeg?ex=686694b7&is=68654337&hm=b3f9fed47697fa212c2b9be08389198c0875cbd2a76a9bad0703077dbd79b965&=&format=webp&width=499&height=800", desc: { th: "เทพแห่งสงคราม การต่อสู้ และความโหดร้าย เป็นบุตรชายของซูสและเฮร่า เขากล้าหาญ ดุดัน และไม่กลัวสิ่งใด", en: "God of war, battle, and brutality. He is the son of Zeus and Hera, known for his bravery, aggression, and fearlessness.", zh: "战争、战斗和残暴之神。他常被描绘成手持闪电，身边伴有老鹰。" }, reason: { th: "กล้าหาญ, ตรงไปตรงมา, และไม่กลัวความท้าทาย", en: "brave, direct, and fearless in the face of challenges", zh: "勇敢、直接、无畏挑战" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B9%81%E0%B8%AD%E0%B8%A3%E0%B8%B5%E0%B8%AA", en: "https://en.wikipedia.org/wiki/Ares", zh: "https://zh.wikipedia.org/wiki/%E9%98%BF%E7%91%9E%E6%96%AF" } },
            Aphrodite: { name: { th: "อโฟรไดท์", en: "Aphrodite", zh: "阿佛洛狄忒" }, img: "https://media.discordapp.net/attachments/893104637656334348/1389977277483319407/aphrodite.jpg?ex=686694b7&is=68654337&hm=4f9b1bf14560411e0f11a959de64fb9e51c31c78a30873f2011e1ec8a085b9df&=&format=webp&width=499&height=800", desc: { th: "เทพีแห่งความรัก ความงาม ความสุข และความเจริญรุ่งเรือง เธอเกิดจากฟองคลื่นทะเล มีเสน่ห์และรักสันติ", en: "Goddess of love, beauty, pleasure, and procreation. Born from the sea foam, she is charming and peaceful.", zh: "爱、美、快乐和繁殖女神。她诞生于海浪泡沫中，迷人且热爱和平。" }, reason: { th: "มีเสน่ห์, รักความงาม, และชื่นชอบความสัมพันธ์ที่ดี", en: "charming, graceful, and value love and beauty", zh: "有魅力、爱美、重视良好关系" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B8%AD%E0%B8%B0%E0%B9%82%E0%B8%9F%E0%B8%A3%E0%B9%84%E0%B8%94%E0%B8%97%E0%B8%B5", en: "https://en.wikipedia.org/wiki/Aphrodite", zh: "https://zh.wikipedia.org/wiki/%E9%98%BF%E4%BD%9B%E6%B4%9B%E7%AC%9B%E5%BF%97" } },
            Hephaestus: { name: { th: "เฮเฟสทัส", en: "Hephaestus", zh: "赫菲斯托斯" }, img: "https://media.discordapp.net/attachments/893104637656334348/1389977278397812767/hephaestuse.jpg?ex=686694b7&is=68654337&hm=0694fce5c0b6b7028e5b254fda9b15906c20473e11d00ffefd9b2b0c24e59b43&=&format=webp&width=499&height=799", desc: { th: "เทพแห่งไฟ โลหะ การช่างฝีมือ และภูเขาไฟ เป็นช่างตีเหล็กแห่งเทพเจ้าผู้สร้างสรรค์สิ่งประดิษฐ์อันงดงาม เขามีความขยันและสร้างสรรค์", en: "God of fire, metalworking, craftsmanship, and volcanoes. He is the blacksmith of the gods, creating beautiful artifacts. He is diligent and creative.", zh: "火、金属加工、手工艺和火山之神。他勤奋且富有创造力。" }, reason: { th: "สร้างสรรค์, มีความมุ่งมั่น, และชอบประดิษฐ์สิ่งใหม่ๆ", en: "creative, diligent, and enjoy building new things", zh: "有创造力、勤奋、喜欢创造新事物" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B9%80%E0%B8%AE%E0%B9%80%E0%B8%9F%E0%B8%AA%E0%B8%97%E0%B8%B1%E0%B8%AA", en: "https://en.wikipedia.org/wiki/Hephaestus", zh: "https://zh.wikipedia.org/wiki/%E8%B5%AB%E8%8F%B2%E6%96%AF%E6%89%98%E6%96%AF" } },
            Hermes: { name: { th: "เฮอร์มีส", en: "Hermes", zh: "赫尔墨斯" }, img: "https://media.discordapp.net/attachments/893104637656334348/1389977296533848094/hermes.jpg?ex=686694bc&is=6865433c&hm=32c69d3b26c13a189357e08c1155f3d6c5d5fff4936d31d34b8f5061308a5323&=&format=webp&width=500&height=800", desc: { th: "เทพแห่งการสื่อสาร การเดินทาง โจร และนักกีฬา เป็นผู้ส่งสารของเทพเจ้าและเป็นผู้คุ้มครองการค้าและคนเดินทาง เขาว่องไวและเจ้าเล่ห์", en: "God of communication, travel, thieves, and athletes. He is the messenger of the gods and protector of trade and travelers. He is swift and clever.", zh: "信息、旅行、小偷和运动员之神。他敏捷而狡黠，是众神的信使，商业和旅行者的守护神。" }, reason: { th: "ฉลาดเฉลียว, ปรับตัวเก่ง, และชอบการเดินทางหรือการสื่อสาร", en: "witty, adaptable, and a great communicator or traveler", zh: "机智、适应性强、善于沟通或旅行" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B9%80%E0%B8%AE%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%A1%E0%B8%B5%E0%B8%AA", en: "https://en.wikipedia.org/wiki/Hermes", zh: "https://zh.wikipedia.org/wiki/%E8%B5%AB%E5%B0%94%E9%BB%8F%E6%96%AF" } },
            Dionysus: { name: { th: "ไดโอนิซัส", en: "Dionysus", zh: "狄俄尼索斯" }, img: "https://cdn.discordapp.com/attachments/893104637656334348/1389977275394560020/AestheticMale_-verve_Dionysus.jpg?ex=686694b6&is=68654336&hm=950da542e976a70c3cc2c3ccb2dba35767d550250df27afafee7a6ebc53678ec&", desc: { th: "เทพแห่งไวน์ ความอุดมสมบูรณ์ พิธีเฉลิมฉลอง และละคร เขาเป็นเทพเจ้าที่ส่งเสริมการปลดปล่อยและความสุข เขามักเกี่ยวข้องกับความสนุกสนาน ความคิดสร้างสรรค์ และการเปลี่ยนแปลง", en: "God of wine, fertility, ritual madness, and theatre. He is a god who inspires ecstasy and revelry, often associated with pleasure, creativity, and transformation.", zh: "葡萄酒、丰饶、狂喜和戏剧之神。他是一位激发狂喜和欢庆的神，常与享乐、创造力和转变相关联。" }, reason: { th: "รักอิสระ, ชอบความสนุกสนาน, และมีด้านที่สร้างสรรค์หรือลึกลับ", en: "free-spirited, enjoys pleasure, and has a creative or mysterious side", zh: "热爱自由、享受快乐、有创造力或神秘的一面" }, source: { th: "https://th.wikipedia.org/wiki/%E0%B9%84%E0%B8%94%E0%B9%82%E0%B8%AD%E0%B8%99%E0%B8%B4%E0%B8%8B%E0%B8%B1%E0%B8%AA", en: "https://en.wikipedia.org/wiki/Dionysus", zh: "https://zh.wikipedia.org/wiki/%E7%8B%84%E4%BF%84%E5%B0%BC%E7%B4%A2%E6%96%AF" } }
        };

        const questionsByLang = {
            th: [
                { question: "คุณคิดว่าคุณเป็นคนแบบไหน?", answers: [
                    { text: "ฉลาด รอบคอบ", type: "Athena" },
                    { text: "เด็ดขาด มีอำนาจ", type: "Zeus" },
                    { text: "ใจดี ดูแลคนอื่น", type: "Demeter" },
                    { text: "รักอิสระ ชอบปาร์ตี้", type: "Dionysus" }
                ]},
                { question: "สถานที่โปรดของคุณคือที่ไหน?", answers: [
                    { text: "ห้องสมุดหรือเวิร์คช็อป", type: "Hephaestus" },
                    { text: "ป่าเขาหรือธรรมชาติ", type: "Artemis" },
                    { text: "ชายทะเลหรือแม่น้ำ", type: "Poseidon" },
                    { text: "บาร์, โรงละคร, หรือเทศกาล", type: "Dionysus" }
                ]},
                { question: "คุณชอบกิจกรรมแบบไหนมากที่สุด?", answers: [
                    { text: "การเรียนรู้หรือพัฒนาไอเดียใหม่", type: "Athena" },
                    { text: "เข้าสังคม พบปะผู้คน", type: "Hermes" },
                    { text: "จัดบ้าน ปลูกต้นไม้", type: "Demeter" },
                    { text: "เข้าร่วมงานเฉลิมฉลองหรือกิจกรรมสร้างสรรค์", type: "Dionysus" }
                ]},
                { question: "คุณมีข้อดีเด่นด้านใด?", answers: [
                    { text: "ความกล้าหาญ", type: "Ares" },
                    { text: "ความรักและความเข้าใจ", type: "Aphrodite" },
                    { text: "ความยุติธรรม", type: "Zeus" },
                    { text: "การสื่อสาร", type: "Hermes" }
                ]},
                { question: "สัตว์ที่คุณรู้สึกเชื่อมโยงมากที่สุดคือ?", answers: [
                    { text: "นกฮูก", type: "Athena" },
                    { text: "หมาป่า", type: "Ares" },
                    { text: "ม้า", type: "Poseidon" },
                    { text: "เสือดำหรือแพะ", type: "Dionysus" }
                ]},
                { question: "คนรอบข้างมักบอกว่าคุณเป็นอย่างไร?", answers: [
                    { text: "ชาญฉลาด", type: "Athena" },
                    { text: "มีเสน่ห์", type: "Aphrodite" },
                    { text: "สนุกสนาน ตลก", type: "Hermes" },
                    { text: "มีชีวิตชีวา น่าตื่นเต้น", type: "Dionysus" }
                ]},
                { question: "คุณอยากมีพลังพิเศษแบบใด?", answers: [
                    { text: "ควบคุมทะเลและพายุ", type: "Poseidon" },
                    { text: "สื่อสารและเคลื่อนย้ายได้รวดเร็ว", type: "Hermes" },
                    { text: "ปลูกพืชผลได้ไม่จำกัด", type: "Demeter" },
                    { text: "เปลี่ยนน้ำเป็นไวน์ หรือสร้างความสุขให้คนรอบข้าง", type: "Dionysus" }
                ]},
                { question: "คุณอยากเป็นที่จดจำในเรื่องใด?", answers: [
                    { text: "ปัญญาและการให้คำแนะนำ", type: "Athena" },
                    { text: "ความกล้าหาญในสงคราม", type: "Ares" },
                    { text: "ความรักและความงาม", type: "Aphrodite" },
                    { text: "การสร้างสรรค์ผลงาน", type: "Hephaestus" }
                ]},
                { question: "สีที่สะท้อนตัวคุณมากที่สุดคือ?", answers: [
                    { text: "ทองและเงิน", type: "Zeus" },
                    { text: "เขียวธรรมชาติ", type: "Demeter" },
                    { text: "แดงเข้มหรือบรอนซ์", type: "Ares" },
                    { text: "ม่วงหรือสีเขียวของเถาองุ่น", type: "Dionysus" }
                ]},
                { question: "คุณจัดการกับความขัดแย้งอย่างไร?", answers: [
                    { text: "ใช้เหตุผลและพูดคุย", type: "Athena" },
                    { text: "เผชิญหน้าและแก้ปัญหาโดยตรง", type: "Ares" },
                    { text: "หลีกเลี่ยงและหาทางปลดปล่อย", type: "Dionysus" },
                    { text: "หาวิธีสร้างสันติ", type: "Aphrodite" }
                ]}
            ],
            en: [
                { question: "How would you describe yourself?", answers: [
                    { text: "Smart and thoughtful", type: "Athena" },
                    { text: "Decisive and powerful", type: "Zeus" },
                    { text: "Kind and caring", type: "Demeter" },
                    { text: "Free-spirited and festive", type: "Dionysus" }
                ]},
                { question: "What's your favorite place?", answers: [
                    { text: "Library or workshop", type: "Hephaestus" },
                    { text: "Forest or nature", type: "Artemis" },
                    { text: "Beach or river", type: "Poseidon" },
                    { text: "A bar, theater, or festival", type: "Dionysus" }
                ]},
                { question: "What do you like to do in your free time?", answers: [
                    { text: "Read books", type: "Athena" },
                    { text: "Draw or play music", type: "Apollo" },
                    { text: "Cook or take care of home", type: "Demeter" },
                    { text: "Attend celebrations or creative events", type: "Dionysus" }
                ]},
                { question: "What is your greatest strength?", answers: [
                    { text: "Bravery", type: "Ares" },
                    { text: "Love and empathy", type: "Aphrodite" },
                    { text: "Justice", type: "Zeus" },
                    { text: "Communication", type: "Hermes" }
                ]},
                { question: "Which animal do you feel most connected to?", answers: [
                    { text: "Owl", type: "Athena" },
                    { text: "Wolf", type: "Ares" },
                    { text: "Horse", type: "Poseidon" },
                    { text: "Panther or Goat", "type": "Dionysus" }
                ]},
                { question: "How do you want people to remember you?", answers: [
                    { text: "Smart and talented", type: "Athena" },
                    { text: "Charming and lovely", type: "Aphrodite" },
                    { text: "Strong and bold", type: "Ares" },
                    { text: "Lively and exciting", type: "Dionysus" }
                ]},
                { question: "If you could have one superpower, what would it be?", answers: [
                    { text: "Control nature", type: "Poseidon" },
                    { text: "Control fire", type: "Hephaestus" },
                    { text: "Talk to anyone", type: "Hermes" },
                    { text: "Turn water into wine or bring joy to others", type: "Dionysus" }
                ]},
                { question: "What do you value the most?", answers: [
                    { text: "Knowledge", type: "Athena" },
                    { text: "Freedom", type: "Artemis" },
                    { text: "Family", type: "Hera" },
                    { text: "Pleasure and revelry", type: "Dionysus" }
                ]},
                { question: "What’s your fashion style?", answers: [
                    { text: "Elegant", type: "Hera" },
                    { text: "Casual and comfy", type: "Demeter" },
                    { text: "Trendy and bold", type: "Apollo" },
                    { text: "Vibrant and free-flowing", type: "Dionysus" }
                ]},
                { question: "How do you deal with conflict?", answers: [
                    { text: "Talk with reason", type: "Athena" },
                    { text: "Avoid and wait", type: "Dionysus" },
                    { text: "Solve it directly", type: "Ares" },
                    { text: "Let it flow", type: "Aphrodite" }
                ]}
            ],
            zh: [
                { question: "你认为自己是哪种类型的人？", answers: [
                    { text: "聪明，细心", type: "Athena" },
                    { text: "果断，有权威", type: "Zeus" },
                    { text: "善良，关心他人", type: "Demeter" },
                    { text: "自由奔放，热爱节日", type: "Dionysus" }
                ]},
                { question: "你最喜欢的地方是哪里？", answers: [
                    { text: "图书馆或工作室", type: "Hephaestus" },
                    { text: "森林或大自然", type: "Artemis" },
                    { text: "海边或河流", type: "Poseidon" },
                    { text: "酒吧、剧院或节日", type: "Dionysus" }
                ]},
                { question: "你最喜欢哪种活动？", answers: [
                    { text: "学习或发展新想法", type: "Athena" },
                    { text: "社交，结识新朋友", type: "Hermes" },
                    { text: "整理家务，种植花草", type: "Demeter" },
                    { text: "参加庆祝活动或创意活动", type: "Dionysus" }
                ]},
                { question: "你有什么突出的优点？", answers: [
                    { text: "勇气", type: "Ares" },
                    { text: "爱与理解", type: "Aphrodite" },
                    { text: "公正", type: "Zeus" },
                    { text: "沟通", type: "Hermes" }
                ]},
                { question: "你觉得自己与哪种动物联系最紧密？", answers: [
                    { text: "猫头鹰", type: "Athena" },
                    { text: "狼", type: "Ares" },
                    { text: "马", type: "Poseidon" },
                    { text: "黑豹或山羊", type: "Dionysus" }
                ]},
                { question: "周围的人通常怎么评价你？", answers: [
                    { text: "睿智", type: "Athena" },
                    { text: "有魅力", type: "Aphrodite" },
                    { text: "有趣，幽默", type: "Hermes" },
                    { text: "充满活力，令人兴奋", type: "Dionysus" }
                ]},
                { question: "你想要哪种超能力？", answers: [
                    { text: "控制ทะเลและพายุ", type: "Poseidon" },
                    { text: "สื่อสารและเคลื่อนย้ายได้รวดเร็ว", type: "Hermes" },
                    { text: "ปลูกพืชผลได้ไม่จำกัด", type: "Demeter" },
                    { text: "把水变成酒或给他人带来快乐", type: "Dionysus" }
                ]},
                { question: "คุณอยากเป็นที่จดจำในเรื่องใด?", answers: [
                    { text: "ปัญญาและการให้คำแนะนำ", type: "Athena" },
                    { text: "ความกล้าหาญในสงคราม", type: "Ares" },
                    { text: "ความรักและความงาม", type: "Aphrodite" },
                    { text: "การสร้างสรรค์ผลงาน", type: "Hephaestus" }
                ]},
                { question: "สีที่สะท้อนตัวคุณมากที่สุดคือ?", answers: [
                    { text: "ทองและเงิน", type: "Zeus" },
                    { text: "เขียวธรรมชาติ", type: "Demeter" },
                    { text: "แดงเข้มหรือบรอนซ์", type: "Ares" },
                    { text: "紫色或葡萄藤的绿色", type: "Dionysus" }
                ]},
                { question: "คุณจัดการกับความขัดแย้งอย่างไร?", answers: [
                    { text: "ใช้เหตุผลและพูดคุย", type: "Athena" },
                    { text: "直接面对并解决问题", type: "Ares" },
                    { text: "避开并寻找释放方式", type: "Dionysus" },
                    { text: "寻求和平", type: "Aphrodite" }
                ]}
            ]
        };

        const scores = {};
        const userAnswers = [];
        let current = 0;
        let lang = "en"; // ตั้งค่าเริ่มต้นเป็นภาษาอังกฤษ
        let questions = questionsByLang[lang];

        const quizSection = document.getElementById("quiz-section");
        const historySection = document.getElementById("history-section");
        const quizNavLink = document.getElementById("quiz-nav-link");
        const historyNavLink = document.getElementById("history-nav-link");
        const prevBtn = document.getElementById("prev-btn");
        const nextBtn = document.getElementById("next-btn"); // ยังไม่ได้ใช้งานจริงในโค้ดนี้ แต่เก็บไว้ได้
        const progressIndicator = document.getElementById("progress-indicator");
        const godCardGrid = document.getElementById("god-card-grid");
        const godDetailView = document.getElementById("god-detail-view");
        const detailGodImg = document.getElementById("detail-god-img");
        const detailGodName = document.getElementById("detail-god-name");
        const detailGodDesc = document.getElementById("detail-god-desc");
        const detailGodSource = document.getElementById("detail-god-source"); // เพิ่ม element นี้

        // Initialise scores
        for (const god in godData) {
            scores[god] = 0;
        }

        // --- Section Management ---
        function showSection(sectionId) {
            if (sectionId === 'quiz') {
                quizSection.style.display = 'block';
                historySection.style.display = 'none';
                quizNavLink.classList.add('active');
                historyNavLink.classList.remove('active');
                restartQuiz(); // Reset quiz when navigating to quiz section
            } else if (sectionId === 'history') {
                quizSection.style.display = 'none';
                historySection.style.display = 'block';
                quizNavLink.classList.remove('active');
                historyNavLink.classList.add('active');
                showHistoryList(); // Show history list when navigating to history section
            }
            updateContentLanguage(); // Update language for the active section
        }

        // --- Language and Theme Toggles ---
        document.getElementById("langToggle").addEventListener("change", (e) => {
            lang = e.target.value;
            questions = questionsByLang[lang]; // Update questions based on new language
            updateContentLanguage();
            // Re-render current view with new language
            if (quizSection.style.display !== 'none') {
                // If on quiz section, restart quiz to apply new language
                restartQuiz();
            } else if (historySection.style.display !== 'none') {
                // If on history section, re-render history or detail view
                if (godDetailView.style.display !== 'none') {
                    const godKey = detailGodImg.alt; // Get godKey from alt attribute
                    showGodDetail(godKey);
                } else {
                    showHistoryList();
                }
            }
        });

        function toggleTheme() {
            const body = document.body;
            if (body.dataset.theme === "light") {
                body.dataset.theme = "dark";
            } else {
                body.dataset.theme = "light";
            }
            updateTransparency();
        }

        function updateTransparency() {
            const root = document.documentElement;
            if (document.body.dataset.theme === "dark") {
                root.style.setProperty('--card-color', 'rgba(52, 58, 64, 0.85)');
                root.style.setProperty('--nav-bg-color', 'rgba(26, 26, 26, 0.9)');
            } else {
                root.style.setProperty('--card-color', 'rgba(255, 255, 255, 0.85)');
                root.style.setProperty('--nav-bg-color', 'rgba(52, 58, 64, 0.9)');
            }
        }

        function updateContentLanguage() {
            document.getElementById("quiz-nav-link").textContent = translations[lang].quizNavLink;
            document.getElementById("history-nav-link").textContent = translations[lang].historyNavLink;

            document.getElementById("quiz-title").textContent = translations[lang].title;
            // Only update quiz content if quiz is currently visible
            if (quizSection.style.display !== 'none') {
                 if (document.getElementById("result").innerHTML !== '') {
                    // If result is shown, re-render result with new language
                    showResult();
                } else {
                    // Otherwise, re-render current question
                    showQuestion();
                }
            }
            
            document.getElementById("history-title").textContent = translations[lang].historyTitle;
            document.getElementById("history-intro").textContent = translations[lang].historyIntro;
            document.getElementById("back-to-history-btn").textContent = translations[lang].backToHistoryBtn;

            // Update history content if history is currently visible
            if (historySection.style.display !== 'none') {
                if (godDetailView.style.display !== 'none') {
                    const godKey = detailGodImg.alt; // Use alt attribute to store godKey
                    showGodDetail(godKey); // Re-render detail view with new language
                } else {
                    showHistoryList(); // Re-render history list with new language
                }
            }
        }

        // --- Quiz Functions ---
        function showQuestion() {
            if (!questions || questions.length === 0) {
                console.error("Questions not found for the current language.");
                return;
            }

            const q = questions[current];
            document.getElementById("question-box").textContent = q.question;
            const btns = document.getElementById("buttons");
            btns.innerHTML = "";

            q.answers.forEach((a, index) => {
                const btn = document.createElement("button");
                btn.textContent = a.text;
                // Highlight selected answer if returning to a previous question
                if (userAnswers[current] && userAnswers[current].index === index) {
                    btn.classList.add('selected');
                }
                btn.onclick = () => selectAnswer(a.type, index);
                btns.appendChild(btn);
            });

            updateNavigationButtons();
            updateProgressIndicator();
        }

        function updateNavigationButtons() {
            if (current === 0) {
                prevBtn.style.display = "none";
            } else {
                prevBtn.style.display = "inline-block";
                prevBtn.textContent = translations[lang].prevBtn;
            }

            // nextBtn is not explicitly used for navigation, answers automatically move to next question
            // It was commented out in original code, so keeping it hidden unless functionality is added
            nextBtn.style.display = "none";
        }

        function updateProgressIndicator() {
            progressIndicator.textContent = translations[lang].progressText
                .replace('{current}', current + 1)
                .replace('{total}', questions.length);
        }

        function selectAnswer(type, answerIndex) {
            const currentQuestionButtons = document.querySelectorAll('#buttons button');
            currentQuestionButtons.forEach(button => button.classList.remove('selected'));
            currentQuestionButtons[answerIndex].classList.add('selected');

            userAnswers[current] = { type: type, index: answerIndex };

            // Reset scores and recalculate based on all selected answers so far
            for (const god in scores) {
                if (scores.hasOwnProperty(god)) {
                    scores[god] = 0; // Reset
                }
            }
            userAnswers.forEach(answer => {
                if (answer) { // Ensure answer is not undefined/null (can happen if user navigates back and forth)
                    scores[answer.type] = (scores[answer.type] || 0) + 1;
                }
            });

            if (current < questions.length - 1) {
                current++;
                showQuestion();
            } else {
                // If it's the last question, show result after a slight delay
                setTimeout(() => {
                    showResult();
                    triggerFireworks();
                }, 300);
            }
        }

        function prevQuestion() {
            if (current > 0) {
                current--;
                showQuestion();
                document.getElementById("quiz-container").style.display = "block";
                document.getElementById("result").innerHTML = ""; // Clear result if user goes back
            }
        }

        function showResult() {
            let top = null, max = -1; // Initialize max with -1 to handle all zeros

            // Scores are already calculated and updated in selectAnswer()
            // No need to recalculate or reset here

            for (let god in scores) {
                if (scores.hasOwnProperty(god)) {
                    if (scores[god] > max) {
                        max = scores[god];
                        top = god;
                    }
                }
            }

            const finalGod = top;

            const g = godData[finalGod];
            if (!g) {
                document.getElementById("result").innerHTML = `<p>${translations[lang].cannotProcessResult}</p>`;
                document.getElementById("quiz-container").style.display = "none";
                return;
            }
            document.getElementById("quiz-container").style.display = "none";
            document.getElementById("result").innerHTML = `
                <h2>${translations[lang].resultPrefix} ${g.name[lang]}</h2>
                <img src="${g.img}" alt="${finalGod}" />
                <p>${g.desc[lang]}</p>
                <p class="reason-text">${translations[lang].reasonPrefix} ${g.reason[lang]}</p>
                <button onclick="restartQuiz()">${translations[lang].restartBtn}</button>
                <a href="${g.source[lang]}" target="_blank" class="source-link">${translations[lang].sourceLinkText}</a>
            `;
        }

        function restartQuiz() {
            current = 0;
            userAnswers.length = 0; // Clear all stored answers
            for (const god in scores) {
                scores[god] = 0; // Reset all scores
            }
            document.getElementById("quiz-container").style.display = "block";
            document.getElementById("result").innerHTML = ""; // Clear result display
            showQuestion(); // Start quiz from the first question
        }

        // --- History Functions ---
        function showHistoryList() {
            godDetailView.style.display = 'none'; // Hide detail view
            godCardGrid.style.display = 'grid'; // Show grid of cards
            godCardGrid.innerHTML = ''; // Clear previous cards

            for (const godKey in godData) {
                const god = godData[godKey];
                const card = document.createElement('div');
                card.classList.add('god-card');
                card.onclick = () => showGodDetail(godKey);
                // Display truncated description and language-specific source link
                card.innerHTML = `
                    <img src="${god.img}" alt="${godKey}">
                    <h3>${god.name[lang]}</h3>
                    <p>${god.desc[lang].substring(0, 100)}...</p>
                    <a href="${god.source[lang]}" target="_blank" class="source-link">${translations[lang].sourceLinkText}</a>
                `;
                godCardGrid.appendChild(card);
            }
        }

        function showGodDetail(godKey) {
            const god = godData[godKey];
            if (!god) {
                console.error("God data not found for key:", godKey);
                return;
            }
            godCardGrid.style.display = 'none'; // Hide card grid
            godDetailView.style.display = 'block'; // Show detail view

            detailGodImg.src = god.img;
            detailGodImg.alt = godKey; // Store godKey in alt attribute
            detailGodName.textContent = god.name[lang];
            detailGodDesc.textContent = god.desc[lang];
            detailGodSource.href = god.source[lang]; // Update link based on current language
            detailGodSource.textContent = translations[lang].sourceLinkText; // Update link text
        }

        // --- Confetti Function ---
        function triggerFireworks() {
            const duration = 5 * 1000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            const interval = setInterval(function() {
                const timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                const particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);
        }

        // --- Initial Setup on Page Load ---
        document.addEventListener('DOMContentLoaded', () => {
            // Set default language for dropdown
            document.getElementById("langToggle").value = lang;
            showSection('quiz'); // Start with the quiz section by default
            updateTransparency(); // Apply initial theme transparency
        });
    </script>
</body>
</html>
